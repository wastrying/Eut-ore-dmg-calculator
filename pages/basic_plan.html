<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Remblyx Dashboard - Basic Plan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    *{box-sizing:border-box;margin:0;padding:0;font-family:Arial,sans-serif;}
    body{background:#f5f5f5;min-height:100vh;color:#222;display:flex;justify-content:center;align-items:flex-start;padding:16px;}
    .wrapper{width:100%;max-width:1200px;margin-top:58px;display:flex;flex-direction:column;gap:16px;}
    .board-wrapper{background:#f9fafb;border:1px solid #e5e7eb;border-radius:12px;padding:16px;max-width:600px;}
    button{padding:8px 12px;border:none;border-radius:6px;background:#4CAF50;color:white;cursor:pointer;transition:background 0.2s ease;}
    button:hover{background:#45a049;}
    .dependant-info{margin-top:12px;padding:12px;background:#fff;border-left:4px solid #4CAF50;border-radius:6px;}
    .dependant-actions{display:flex;gap:8px;margin-top:10px;}

    /* Modal */
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);justify-content:center;align-items:center;z-index:1000;}
    .modal.active{display:flex;animation:fadeIn 0.25s ease;}
    .modal-content{background:#fff;padding:20px;border-radius:12px;width:90%;max-width:400px;box-shadow:0 8px 24px rgba(0,0,0,0.3);animation:slideUp 0.3s ease;}
    .modal-content h2{margin-top:0;}
    .modal-content label{display:block;margin:8px 0 4px;font-weight:600;}
    .modal-content input,.modal-content select{width:100%;padding:6px 8px;margin-bottom:10px;border:1px solid #ccc;border-radius:6px;box-sizing:border-box;}
    .modal-content .dosage-row{display:flex;gap:6px;}
    .modal-content .dosage-row input{flex:1;}
    .modal-content .dosage-row select{flex:1;}
    .error{color:red;font-weight:bold;margin-bottom:8px;}

    /* Time pickers vertically stacked */
    .time-picker-container{display:none;margin-top:10px;}
    .time-picker-list{display:flex;flex-direction:column;gap:8px;}
    .time-item{display:flex;flex-direction:column;}
    .time-item label{font-weight:normal;margin-bottom:3px;}
    .time-item input[type="time"]{padding:6px;border:1px solid #ccc;border-radius:6px;}

    /* Confirmation Popup */
    .confirm-popup {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }
    .confirm-popup.active {
      display: flex;
      animation: fadeIn 0.25s ease;
    }
    .confirm-box {
      background: white;
      padding: 24px;
      border-radius: 14px;
      text-align: center;
      width: 90%;
      max-width: 380px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.3);
      animation: slideUp 0.3s ease;
    }
    .confirm-box h3 {
      margin-bottom: 16px;
      color: #111;
      font-size: 17px;
      line-height: 1.5;
    }
    .confirm-buttons {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 10px;
    }
    .confirm-buttons button {
      padding: 8px 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      color: white;
      font-weight: bold;
      transition: background 0.2s ease, transform 0.15s ease;
    }
    .confirm-buttons button:active {transform: scale(0.97);}
    .confirm-delete {background: #ef4444;}
    .confirm-delete:hover {background: #dc2626;}
    .confirm-cancel {background: #9ca3af;}
    .confirm-cancel:hover {background: #6b7280;}

    /* Animations */
    @keyframes fadeIn {from{opacity:0;} to{opacity:1;}}
    @keyframes slideUp {from{transform:translateY(30px);opacity:0;} to{transform:translateY(0);opacity:1;}}
  </style>
</head>
<body>
<div class="wrapper">
  <div class="board-wrapper">
    <h2>Basic Plan Dashboard</h2>
    <button id="addDependantBtn">Add Dependant</button>

    <div id="dependantInfo" class="dependant-info" style="display:none;">
      <h3>Dependant Profile</h3>
      <p><strong>Name:</strong> <span id="dispName"></span></p>
      <p><strong>Medicine Type:</strong> <span id="dispMedicine"></span></p>
      <p><strong>Times to Take Medicine:</strong> <span id="dispTimes"></span></p>
      <p><strong>Dosage:</strong> <span id="dispDosage"></span></p>
      <p><strong>Additional Notes:</strong> <span id="dispNotes"></span></p>
      <div class="dependant-actions">
        <button id="editDependantBtn" style="background:#3b82f6;">Edit</button>
        <button id="removeDependantBtn" style="background:#f87171;">Remove</button>
      </div>
    </div>
  </div>
</div>

<!-- Add/Edit Modal -->
<div id="dependantModal" class="modal">
  <div class="modal-content">
    <h2 id="modalTitle">Add Dependant</h2>
    <p class="error" id="modalError"></p>
    <form id="dependantForm">
      <label for="depName">Name:</label>
      <input type="text" id="depName" required />

      <label for="depMedicine">Type of Medicine:</label>
      <input type="text" id="depMedicine" required />

      <label for="depDosage">Dosage:</label>
      <div class="dosage-row">
        <input type="number" id="depDosageNumber" min="0" placeholder="Amount" required />
        <select id="depDosageUnit" required>
          <option value="">Unit</option>
          <option value="mg">mg</option>
          <option value="g">g</option>
        </select>
      </div>

      <label for="depDosageTimes">Times per day:</label>
      <input type="number" id="depDosageTimes" min="1" max="10" placeholder="Enter number of times" required />

      <div id="timePickerContainer" class="time-picker-container">
        <label>Times to Take Medicine:</label>
        <div id="timeInputs" class="time-picker-list"></div>
      </div>

      <label for="depNotes">Additional Notes:</label>
      <input type="text" id="depNotes" placeholder="Enter 'NA' if none" required />

      <button type="submit">Save Dependant</button>
      <button type="button" id="closeModalBtn" style="background:#9ca3af;margin-top:4px;">Cancel</button>
    </form>
  </div>
</div>

<!-- Delete Confirmation Popup -->
<div id="confirmPopup" class="confirm-popup">
  <div class="confirm-box">
    <h3>Are you sure you want to delete this?<br>Once deleted, it canâ€™t be recovered.</h3>
    <div class="confirm-buttons">
      <button id="confirmDeleteBtn" class="confirm-delete">Delete</button>
      <button id="cancelDeleteBtn" class="confirm-cancel">Cancel</button>
    </div>
  </div>
</div>

<script>
  let dependantAdded = false;
  let editing = false;

  const addBtn = document.getElementById('addDependantBtn');
  const editBtn = document.getElementById('editDependantBtn');
  const removeBtn = document.getElementById('removeDependantBtn');
  const modal = document.getElementById('dependantModal');
  const closeModalBtn = document.getElementById('closeModalBtn');
  const form = document.getElementById('dependantForm');
  const errorMsg = document.getElementById('modalError');
  const modalTitle = document.getElementById('modalTitle');

  const infoBox = document.getElementById('dependantInfo');
  const dispName = document.getElementById('dispName');
  const dispMedicine = document.getElementById('dispMedicine');
  const dispTimes = document.getElementById('dispTimes');
  const dispDosage = document.getElementById('dispDosage');
  const dispNotes = document.getElementById('dispNotes');

  const dosageTimesInput = document.getElementById('depDosageTimes');
  const timePickerContainer = document.getElementById('timePickerContainer');
  const timeInputs = document.getElementById('timeInputs');

  const confirmPopup = document.getElementById('confirmPopup');
  const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
  const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');

  // Add dependant
  addBtn.addEventListener('click', () => {
    if(dependantAdded && !editing){
      alert("You can only add one dependant in the Basic plan.");
      return;
    }
    modalTitle.textContent = editing ? "Edit Dependant" : "Add Dependant";
    modal.classList.add('active');
  });

  // Close modal
  closeModalBtn.addEventListener('click', () => {
    modal.classList.remove('active');
    form.reset();
    timePickerContainer.style.display = 'none';
    errorMsg.textContent = '';
  });

  // Show time pickers vertically
  dosageTimesInput.addEventListener('input', () => {
    const count = parseInt(dosageTimesInput.value);
    timeInputs.innerHTML = '';
    if(count > 0){
      timePickerContainer.style.display = 'block';
      for(let i=1;i<=count;i++){
        const div = document.createElement('div');
        div.classList.add('time-item');
        const label = document.createElement('label');
        label.textContent = `Time ${i}:`;
        const input = document.createElement('input');
        input.type = 'time';
        input.required = true;
        div.appendChild(label);
        div.appendChild(input);
        timeInputs.appendChild(div);
      }
    } else {
      timePickerContainer.style.display = 'none';
    }
  });

  // Save dependant
  form.addEventListener('submit', function(e){
    e.preventDefault();

    const name = depName.value.trim();
    const medicine = depMedicine.value.trim();
    const dosageNumber = depDosageNumber.value.trim();
    const dosageUnit = depDosageUnit.value;
    const dosageTimes = depDosageTimes.value.trim();
    const notes = depNotes.value.trim();
    const timeValues = Array.from(timeInputs.querySelectorAll('input[type="time"]')).map(i=>i.value);

    if(!name || !medicine || !dosageNumber || !dosageUnit || !dosageTimes || timeValues.includes('') || !notes){
      errorMsg.textContent = "Please fill all required fields. Enter 'NA' if there are no additional notes.";
      return;
    }

    const dosageText = `${dosageNumber} ${dosageUnit}, ${dosageTimes} time(s) per day`;
    const timeText = timeValues.join(', ');

    dispName.textContent = name;
    dispMedicine.textContent = medicine;
    dispTimes.textContent = timeText;
    dispDosage.textContent = dosageText;
    dispNotes.textContent = notes;

    infoBox.style.display = 'block';
    dependantAdded = true;
    editing = false;

    modal.classList.remove('active');
    form.reset();
    timePickerContainer.style.display = 'none';
    errorMsg.textContent = '';
  });

  // Edit dependant
  editBtn.addEventListener('click', () => {
    editing = true;
    addBtn.click();
    depName.value = dispName.textContent;
    depMedicine.value = dispMedicine.textContent;
    depDosageNumber.value = dispDosage.textContent.split(' ')[0];
    depDosageUnit.value = dispDosage.textContent.split(' ')[1];
    const timesPerDay = parseInt(dispDosage.textContent.match(/\d+/g)[1]);
    depDosageTimes.value = timesPerDay;
    dosageTimesInput.dispatchEvent(new Event('input'));
    const currentTimes = dispTimes.textContent.split(', ');
    const timeInputsEls = timeInputs.querySelectorAll('input[type="time"]');
    currentTimes.forEach((t, i) => { if(timeInputsEls[i]) timeInputsEls[i].value = t; });
    depNotes.value = dispNotes.textContent;
  });

  // Show confirmation popup
  removeBtn.addEventListener('click', () => {
    if(!dependantAdded) return;
    confirmPopup.classList.add('active');
  });

  // Confirm delete
  confirmDeleteBtn.addEventListener('click', () => {
    infoBox.style.display = 'none';
    dependantAdded = false;
    confirmPopup.classList.remove('active');
    dispName.textContent = '';
    dispMedicine.textContent = '';
    dispTimes.textContent = '';
    dispDosage.textContent = '';
    dispNotes.textContent = '';
  });

  // Cancel delete
  cancelDeleteBtn.addEventListener('click', () => {
    confirmPopup.classList.remove('active');
  });
</script>
</body>
</html>
