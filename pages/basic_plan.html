const dashboardError = document.getElementById('dashboardError');

// In form submit
form.addEventListener('submit', function(e){
  e.preventDefault();

  const name = depName.value.trim();
  const medicine = depMedicine.value.trim();
  const dosageNumber = depDosageNumber.value.trim();
  const dosageUnit = depDosageUnit.value;
  const dosageTimes = depDosageTimes.value.trim();
  const notes = depNotes.value.trim();
  const timeValues = Array.from(timeInputs.querySelectorAll('input[type="time"]')).map(i=>i.value);

  if(!name || !medicine || !dosageNumber || !dosageUnit || !dosageTimes || timeValues.includes('') || !notes){
    dashboardError.textContent = "Please fill all required fields. Enter 'NA' if there are no additional notes.";
    dashboardError.style.display = 'block';
    return;
  }

  // Clear any previous error
  dashboardError.textContent = '';
  dashboardError.style.display = 'none';

  const dosageText = `${dosageNumber} ${dosageUnit}, ${dosageTimes} time(s) per day`;
  const timeText = timeValues.join(', ');

  dispName.textContent = name;
  dispMedicine.textContent = medicine;
  dispTimes.textContent = timeText;
  dispDosage.textContent = dosageText;
  dispNotes.textContent = notes;

  infoBox.style.display = 'block';
  dependantAdded = true;
  editing = false;

  modal.classList.remove('active');
  form.reset();
  timePickerContainer.style.display = 'none';
});
